<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube 博客生成器</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+SC:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <span class="logo-icon">🎬</span>
                <h1>YouTube 博客生成器</h1>
            </div>
            <div class="header-right">
                <div class="status-badge" id="apiStatus">
                    <span class="status-dot"></span>
                    <span class="status-text">检查中...</span>
                </div>
                <button class="btn-icon-only" id="settingsBtn" title="设置">⚙️</button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Panel: Input -->
            <section class="panel input-panel">
                <div class="panel-header">
                    <h2>📥 视频输入</h2>
                </div>

                <!-- Tab Navigation -->
                <div class="tab-nav">
                    <button class="tab-btn active" data-tab="channel">频道视频</button>
                    <button class="tab-btn" data-tab="video">单个视频</button>
                </div>

                <!-- Channel Tab -->
                <div class="tab-content active" id="channelTab">
                    <div class="input-group">
                        <label>YouTube 频道链接</label>
                        <input type="text" id="channelUrl" placeholder="https://www.youtube.com/@channel">
                    </div>
                    <div class="input-group">
                        <label>获取视频数量</label>
                        <input type="number" id="videoCount" value="5" min="1" max="50">
                    </div>
                    <button class="btn btn-primary" id="fetchChannelBtn">
                        <span class="btn-icon">🔍</span>
                        获取视频列表
                    </button>

                    <!-- Video List -->
                    <div class="video-list" id="videoList"></div>
                </div>

                <!-- Video Tab -->
                <div class="tab-content" id="videoTab">
                    <div class="input-group">
                        <label>YouTube 视频链接</label>
                        <input type="text" id="videoUrl" placeholder="https://www.youtube.com/watch?v=...">
                    </div>
                    <button class="btn btn-primary" id="processVideoBtn">
                        <span class="btn-icon">✨</span>
                        生成博客
                    </button>
                </div>
            </section>

            <!-- Right Panel: Blog Preview -->
            <section class="panel preview-panel">
                <div class="panel-header">
                    <h2>📝 博客预览</h2>
                    <div class="panel-actions">
                        <button class="btn btn-secondary btn-sm" id="downloadMdBtn" disabled>
                            📄 下载 MD
                        </button>
                        <button class="btn btn-secondary btn-sm" id="downloadAudioBtn" disabled>
                            🎵 下载音频
                        </button>
                    </div>
                </div>

                <!-- Audio Player -->
                <div class="audio-player hidden" id="audioPlayer">
                    <audio controls id="audioElement"></audio>
                </div>

                <!-- Blog Content -->
                <div class="blog-content" id="blogContent">
                    <div class="placeholder">
                        <span class="placeholder-icon">📝</span>
                        <p>选择视频后，AI 生成的博客将显示在这里</p>
                    </div>
                </div>
            </section>
        </main>

        <!-- Bottom Panel: History -->
        <section class="panel history-panel">
            <div class="panel-header">
                <h2>📚 历史博客</h2>
                <button class="btn btn-secondary btn-sm" id="refreshHistoryBtn">🔄 刷新</button>
            </div>
            <div class="history-list" id="historyList">
                <div class="placeholder">
                    <p>暂无历史记录</p>
                </div>
            </div>
        </section>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay hidden" id="settingsModal">
        <div class="modal">
            <div class="modal-header">
                <h2>⚙️ 设置</h2>
                <button class="modal-close" id="settingsCloseBtn">&times;</button>
            </div>
            <div class="modal-body">
                <!-- Google Login Section -->
                <div class="settings-section">
                    <h3>🔐 Google 登录</h3>
                    <p class="settings-desc">使用 Google 账号登录后，可直接使用 Gemini Pro，无需 API Key</p>
                    <div id="oauthSection">
                        <div id="oauthLoggedOut">
                            <button class="btn btn-google" id="googleLoginBtn">
                                <svg width="18" height="18" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/></svg>
                                使用 Google 登录
                            </button>
                        </div>
                        <div id="oauthLoggedIn" class="hidden">
                            <div class="oauth-status">
                                <span class="oauth-badge">✅ 已通过 Google 登录（Gemini Pro 可用）</span>
                                <button class="btn btn-secondary btn-sm" id="googleLogoutBtn">退出登录</button>
                            </div>
                        </div>
                        <div id="oauthNotConfigured" class="hidden">
                            <p class="settings-hint">⚠️ 需要在 .env 中配置 GOOGLE_CLIENT_ID 和 GOOGLE_CLIENT_SECRET</p>
                        </div>
                    </div>
                </div>

                <hr class="settings-divider">

                <!-- API Keys Section -->
                <div class="settings-section">
                    <h3>🔑 API Keys</h3>
                    <p class="settings-desc">配置 AI 引擎的 API Key（留空则不修改已有配置）</p>

                    <div class="input-group">
                        <label>OpenAI API Key</label>
                        <div class="input-with-status">
                            <input type="password" id="settingsOpenaiKey" placeholder="sk-...">
                            <span class="key-status" id="openaiKeyStatus"></span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Gemini API Key</label>
                        <div class="input-with-status">
                            <input type="password" id="settingsGeminiKey" placeholder="AIza...">
                            <span class="key-status" id="geminiKeyStatus"></span>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Groq API Key</label>
                        <div class="input-with-status">
                            <input type="password" id="settingsGroqKey" placeholder="gsk_...">
                            <span class="key-status" id="groqKeyStatus"></span>
                        </div>
                    </div>
                </div>

                <hr class="settings-divider">

                <!-- TTS Section -->
                <div class="settings-section">
                    <h3>🎤 语音合成</h3>
                    <div class="input-group">
                        <label>TTS 引擎</label>
                        <select id="settingsTtsEngine">
                            <option value="edge">Edge TTS（免费）</option>
                            <option value="openai">OpenAI TTS</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="settingsCancelBtn">取消</button>
                <button class="btn btn-primary" id="settingsSaveBtn">💾 保存设置</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p id="loadingText">处理中...</p>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="/static/app.js"></script>
</body>
</html>
